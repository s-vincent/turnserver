TurnServer
==========

TurnServer is an OpenSource implementation of Traversal Using Relays around NAT (TURN). 
It aims to be compliant with RFC5389 (STUN) and latest TURN draft.

TURN clients can connect to TurnServer with the following protocols: UDP, TCP and TLS over TCP.
For the moment relaying messages can only be done with UDP protocol.

TurnServer is known to work on the following systems:
- GNU/Linux 2.6;
- FreeBSD 7.0.

1) Build / install
------------------

TurnServer requires some libraries: 
- libconfuse development files;
- libssl development files;
- librt (normally included with Linux and *BSD).

TurnServer is written in pure C according to the C99 and POSIX + XSI standards. Thus it 
should be compiled on all POSIX systems which have realtime signals support.

Note for *BSD users, install the required libconfuse ports in /usr/ prefix, otherwise you 
have to set the PKG_CONFIG_PATH variable or make symlinks before running ./configure script:
# ln -sf /usr/local/lib/libconfuse.so /usr/lib/ && ln -sf /usr/local/include/confuse.h /usr/include/

To build TurnServer, run following commands: 
$ aclocal
$ autoheader
$ autoconf 
$ automake --add-missing
$ ./configure
$ make
# make install

You have to set a configuration file and accounts database file (see next sections) before 
launching the server.

Launch the server: 
$ turnserver -c /path/to/config/file

To build doxygen documentation:
$ doxygen Doxyfile

The documentation will be generated in doc/html/ directory.

2) Configuration file
---------------------

In extra/ directory you will find a configuration template file (turnserver.conf.template). 
Change settings according to your environment.

Important parameters are: 
- listen_address: public IPv4 address;
- listen_addressv6: public IPv6 address;
- realm: realm (i.e. domain.org) of the server;
- account_file: specify the location of the accounts database file;
- tcp_port and udp_port: bind the service on the specified port;

If you want to use TLS over TCP you have to set "tls = true" in the configuration file as 
well as the pathnames of the Certificate Authority (CA), server certificate and associated
private key.

Other parameters such as allocations number quota can be configured. For more details about 
configuration parameters, see man files:
$ man turnserver.conf 

3) Accounts database file
--------------------------

TurnServer uses (for the moment) a basic text file which contains accounts information.

The format of each line is:
login:password:realm

Note: realm have to match realm parameter defined in TurnServer configuration file.

4) Security
------------

If TurnServer is launched as root / or set-uid root, it is possible to drop privileges.

One possibility is to create a special user (which have less privileges). To create such 
a user named turnserver:
# adduser --system --group turnserver

Then you have to tell configuration file to choose this user:
unpriv_user = turnserver

if TurnServer is setuid root and unpriv_user is not set, TurnServer will drop
privileges to the user who launched the binary.

Note: if turnserver is launched as root and unpriv_user not set, the program will not
loose its root privileges.

